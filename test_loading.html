<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»ŸåŠ è½½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ” ç³»ç»ŸåŠ è½½è¯Šæ–­æµ‹è¯•</h1>

    <div class="test-section">
        <h2>1. JavaScript æ–‡ä»¶åŠ è½½æµ‹è¯•</h2>
        <div id="js-test"></div>
    </div>

    <div class="test-section">
        <h2>2. ç±»å®šä¹‰æ£€æŸ¥</h2>
        <div id="class-test"></div>
    </div>

    <div class="test-section">
        <h2>3. DOM å…ƒç´ æ£€æŸ¥</h2>
        <div id="dom-test"></div>
    </div>

    <div class="test-section">
        <h2>4. æ§åˆ¶å°æ—¥å¿—</h2>
        <div id="console-test" style="font-family: monospace; background: #f8f9fa; padding: 10px; border-radius: 4px;">
            è¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
        </div>
    </div>

    <!-- åŠ è½½å¿…è¦çš„åº“ -->
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- åŠ è½½é¡¹ç›® JS æ–‡ä»¶ -->
    <script src="js/diagnosis.js"></script>
    <script src="js/app.js"></script>

    <script>
        console.log('=== ç³»ç»ŸåŠ è½½æµ‹è¯•å¼€å§‹ ===');

        // æµ‹è¯•1: JavaScript æ–‡ä»¶æ˜¯å¦åŠ è½½
        function testJSLoading() {
            const results = [];

            // æ£€æŸ¥ diagnosis.js
            if (typeof RestaurantDiagnosisAdvanced !== 'undefined') {
                results.push('<div class="status success">âœ“ diagnosis.js å·²åŠ è½½ (RestaurantDiagnosisAdvanced ç±»å­˜åœ¨)</div>');
                console.log('âœ“ diagnosis.js åŠ è½½æˆåŠŸ');
            } else {
                results.push('<div class="status error">âœ— diagnosis.js æœªåŠ è½½ (RestaurantDiagnosisAdvanced ç±»ä¸å­˜åœ¨)</div>');
                console.error('âœ— diagnosis.js åŠ è½½å¤±è´¥');
            }

            // æ£€æŸ¥ app.js
            if (typeof RestaurantSurveyApp !== 'undefined') {
                results.push('<div class="status success">âœ“ app.js å·²åŠ è½½ (RestaurantSurveyApp ç±»å­˜åœ¨)</div>');
                console.log('âœ“ app.js åŠ è½½æˆåŠŸ');
            } else {
                results.push('<div class="status error">âœ— app.js æœªåŠ è½½ (RestaurantSurveyApp ç±»ä¸å­˜åœ¨)</div>');
                console.error('âœ— app.js åŠ è½½å¤±è´¥');
            }

            // æ£€æŸ¥å…¨å±€ app å®ä¾‹
            if (typeof window.app !== 'undefined') {
                results.push('<div class="status success">âœ“ å…¨å±€ app å®ä¾‹å·²åˆ›å»º</div>');
                console.log('âœ“ å…¨å±€ app å®ä¾‹å­˜åœ¨', window.app);
            } else {
                results.push('<div class="status error">âœ— å…¨å±€ app å®ä¾‹æœªåˆ›å»º</div>');
                console.error('âœ— å…¨å±€ app å®ä¾‹ä¸å­˜åœ¨');
            }

            document.getElementById('js-test').innerHTML = results.join('');
        }

        // æµ‹è¯•2: ç±»å®ä¾‹åŒ–
        function testClassInstantiation() {
            const results = [];

            try {
                const diagnosis = new RestaurantDiagnosisAdvanced();
                results.push('<div class="status success">âœ“ RestaurantDiagnosisAdvanced å¯ä»¥å®ä¾‹åŒ–</div>');
                console.log('âœ“ RestaurantDiagnosisAdvanced å®ä¾‹:', diagnosis);
            } catch (error) {
                results.push('<div class="status error">âœ— RestaurantDiagnosisAdvanced å®ä¾‹åŒ–å¤±è´¥: ' + error.message + '</div>');
                console.error('âœ— RestaurantDiagnosisAdvanced å®ä¾‹åŒ–å¤±è´¥:', error);
            }

            try {
                const app = new RestaurantSurveyApp();
                results.push('<div class="status success">âœ“ RestaurantSurveyApp å¯ä»¥å®ä¾‹åŒ–</div>');
                console.log('âœ“ RestaurantSurveyApp å®ä¾‹:', app);
            } catch (error) {
                results.push('<div class="status error">âœ— RestaurantSurveyApp å®ä¾‹åŒ–å¤±è´¥: ' + error.message + '</div>');
                console.error('âœ— RestaurantSurveyApp å®ä¾‹åŒ–å¤±è´¥:', error);
            }

            document.getElementById('class-test').innerHTML = results.join('');
        }

        // æµ‹è¯•3: DOM å…ƒç´ æ£€æŸ¥
        function testDOMElements() {
            const results = [];
            const requiredElements = [
                'apiUrl',
                'adminKey',
                'loadData',
                'logoutBtn',
                'dataContainer',
                'detailModal'
            ];

            requiredElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    results.push(`<div class="status success">âœ“ æ‰¾åˆ°å…ƒç´ : #${id}</div>`);
                    console.log(`âœ“ å…ƒç´  #${id} å­˜åœ¨`);
                } else {
                    results.push(`<div class="status error">âœ— ç¼ºå°‘å…ƒç´ : #${id}</div>`);
                    console.error(`âœ— å…ƒç´  #${id} ä¸å­˜åœ¨`);
                }
            });

            document.getElementById('dom-test').innerHTML = results.join('');
        }

        // ç­‰å¾… DOM åŠ è½½å®Œæˆ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', runTests);
        } else {
            runTests();
        }

        function runTests() {
            console.log('å¼€å§‹æ‰§è¡Œæµ‹è¯•...');

            setTimeout(() => {
                testJSLoading();
                testClassInstantiation();
                testDOMElements();
                console.log('=== ç³»ç»ŸåŠ è½½æµ‹è¯•å®Œæˆ ===');
            }, 500);
        }
    </script>
</body>
</html>
